var authoriseUserStream = require('lib/stream/authorise-user');
var authoriseUserByRoleStream = require('lib/stream/authorise-user-by-role');

function authoriseUserStreamBuilder(roles) {
  var builder;

  if (!roles) {
    builder = function () {
      return authoriseUserStream();
    };
  }
  else {
    builder = function () {
      return authoriseUserByRoleStream(roles);
    };
  }

  return builder;
}

module.exports = authoriseUserStreamBuilder;
